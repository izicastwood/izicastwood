<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Регистрация</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="nicepage.css" media="screen">
  <link rel="stylesheet" href="Регистрация.css" media="screen">
</head>
<body>
  <div style="display: flex; justify-content: center; align-items: center; min-height: 70vh;">
    <form id="regForm" style="width: 450px;">
      <div style="margin-bottom: 15px;">
        <label for="phone">Телефон</label>
        <input type="tel" id="phone" name="phone" required placeholder="+7XXXXXXXXXX" style="display:block;width:100%;margin-top:4px;padding:8px;">
      </div>
      <div style="margin-bottom: 15px;">
        <label for="email">Эл. почта</label>
        <input type="email" id="email" name="email" required placeholder="Введите email адрес" style="display:block;width:100%;margin-top:4px;padding:8px;">
      </div>
      <div style="margin-bottom: 15px;">
        <label for="password">Пароль</label>
        <input type="password" id="password" name="password" required placeholder="Введите пароль" style="display:block;width:100%;margin-top:4px;padding:8px;">
      </div>
      <div style="margin-bottom: 15px;">
        <input type="checkbox" id="agree" name="agree" required>
        <label for="agree">Я даю согласие на обработку персональных данных</label>
      </div>
      <button type="submit" style="padding:10px 30px;background:#111;color:#fff;border:none;">Регистрация</button>
      <div style="margin-top:12px;">
        <a href="reset.html" style="color:#478ac9;text-decoration:underline;font-size:15px;">Забыли пароль?</a>
      </div>
      <div id="reg-message" style="margin-top:18px;text-align:center;"></div>
    </form>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script>
    // Твой firebaseConfig
    const firebaseConfig = {
      apiKey: "AIzaSyC1akzlj1iHHmGVv-NfyNYzOsXAKO543c9g",
      authDomain: "user-registration-da501.firebaseapp.com",
      projectId: "user-registration-da501",
      storageBucket: "user-registration-da501.appspot.com",
      messagingSenderId: "676255544545",
      appId: "1:676255544545:web:5f1becf75e7e0e4e3933a0",
      measurementId: "G-9S9NX4D6B5"
    };
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    document.getElementById('regForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const phone = document.getElementById('phone').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const agree = document.getElementById('agree').checked;
      const regMsg = document.getElementById('reg-message');

      if (!agree) {
        regMsg.style.color = "red";
        regMsg.textContent = "Поставьте галочку согласия!";
        return;
      }

      regMsg.style.color = "#478ac9";
      regMsg.textContent = "Пробуем зарегистрировать...";

      firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Дополнительно сохраним телефон в профиле (необязательно)
          userCredential.user.updateProfile({
            displayName: phone
          }).then(() => {
            regMsg.style.color = "green";
            regMsg.textContent = "Регистрация успешна! Можете войти на сайте.";
            document.getElementById('regForm').reset();
            // firebase.auth().signOut(); // если надо сразу разлогинить
          });
        })
        .catch((error) => {
          regMsg.style.color = "red";
          regMsg.textContent = "Ошибка: " + error.message;
        });
    });
  </script>
</body>
</html>
